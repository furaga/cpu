## -*- coding: utf-8 -*-
<%inherit file="skeleton.tmp"/>

entity ram is
<%include file="ram_entity.tmp"/>
end ram;

architecture RTL of ram is
	subtype ram_rec_t is ${oc.ram_t()};
	type ram_array_t is array (0 to ${oc.ram_size()}) of ram_rec_t;
	signal addr_in	: integer range 0 to ${oc.ram_size()};

	signal ram_data : ram_array_t;
	signal pre_wea : std_logic_vector(0 downto 0);
	signal data_in : ${oc.reg_t()};

begin
	ram_sim: process(CLKA)
	begin
		if rising_edge(CLKA) then
			pre_wea(0) <= WEA(0);
			addr_in <= conv_integer(ADDRA);
			data_in <= DINA;
			if pre_wea(0)='1' then
				ram_data(addr_in) <= data_in;
			else
				DOUTA <= ram_data(addr_in);
			end if;
		end if;
	end process;

end RTL;
<%namespace name="oc" file="macro.tmp"/>

